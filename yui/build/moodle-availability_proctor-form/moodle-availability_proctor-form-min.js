YUI.add("moodle-availability_proctor-form",function(fe,e){M.availability_proctor=M.availability_proctor||{},M.availability_proctor.form=fe.Object(M.core_availability.plugin),M.availability_proctor.form.rules=null,M.availability_proctor.form.initInner=function(e,a,n,i,t,l){this.rules=e,this.warnings=a,this.scoring=n,this.defaults=t,this.groups=l,this.streamsPresetOptions=i},M.availability_proctor.form.instId=0,M.availability_proctor.form.getNode=function(e){var n,a,i,t,l,o,r,s,c,u,d,m,p,v,L,f,b,j,B,h,g,_,w,y,k,F,S,x,H,U,W,Y,C,$,q,z,G,J,N,K,Q,T,X,Z,I,O,P,R,A,ee,ae,ne,ie,te,le,oe,re,se,ce,V,ue,de;function D(e,a){return a=a||"availability_proctor",M.util.get_string(e,a)}function me(e){var a=D("showmore","core_form");return'<a href="#" class="proctor-moreless" data-more="'+a+'" data-less="'+D("showless","core_form")+'">'+a+'</a><div class="hidden col-md-12">'+e+"</div>"}function E(e,a,n,i){return'<span class="availability-group form-group mb-2 d-flex '+(i?"flex-column":"flex-row")+'"><div class="col-md-'+(i?12:5)+' col-form-label d-flex pb-0 pl-md-0">  <label for="'+e+'">'+a+'</label></div><div class="col-md-'+(i?12:7)+' form-inline align-items-start felement pl-md-0">'+n+"</div></span>"}function pe(e){setTimeout(e,0)}function ve(e){1==e?(y.addClass("btn-primary"),y.removeClass("btn-secondary"),k.addClass("btn-secondary"),k.removeClass("btn-primary"),F.removeClass("hidden"),S.addClass("hidden")):(k.addClass("btn-primary"),k.removeClass("btn-secondary"),y.addClass("btn-secondary"),y.removeClass("btn-primary"),F.addClass("hidden"),S.removeClass("hidden"))}for(U in M.availability_proctor.form.instId+=1,t=(a="proctor"+M.availability_proctor.form.instId)+"_mode",l=a+"_schedulingRequired",o=a+"_autoRescheduling",r=a+"_isTrial",I=a+"_identification",s=a+"_customRules",c=a+"_auxCamera",u=a+"_auxCameraMode",d=a+"_allowmultipledisplays",m=a+"_allowvirtualenvironment",p=a+"_checkidphotoquality",v=a+"_secureBrowser",L=a+"_secureBrowserLevel",f=a+"_preliminaryCheck",b=a+"_userAgreement",O=a+"_webCameraMainView",j=a+"_calculator",B=a+"_streamsPreset",h=a+"_allowedProcesses",g=a+"_forbiddenProcesses",_=a+"_sendManualWarningsToLearner",w=a+"_allowRoomScanAuxCamera",x="white-space: break-spaces; display:flex; align-items: baseline; justify-content: flex-start;",i=E(i=a+"_duration",D("duration"),'<input type="text" name="duration" id="'+i+'" class="form-control">'),i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i+=E(t,D("proctoring_mode"),'<select name="mode" id="'+t+'" class="custom-select">  <option value="online">'+D("online_mode")+'</option>  <option value="identification">'+D("identification_mode")+'</option>  <option value="offline">'+D("offline_mode")+'</option>  <option value="auto">'+D("auto_mode")+"</option></select>"))+E(I,D("identification"),'<select name="identification" id="'+I+'" class="custom-select">  <option value="passport">'+D("passport_identification")+'</option>  <option value="face">'+D("face_identification")+'</option>  <option value="face_and_passport">'+D("face_passport_identification")+'</option>  <option value="skip">'+D("skip_identification")+"</option></select>"))+E(O,D("web_camera_main_view"),'<select name="webcameramainview" id="'+O+'" class="custom-select">  <option value="front">'+D("web_camera_main_view_front")+'</option>  <option value="side">'+D("web_camera_main_view_side")+"</option></select>"))+E(l,D("scheduling_required"),'<input type="checkbox" name="scheduling_required" id="'+l+'" value="1">&nbsp;<label for="'+l+'">'+D("enable")+"</label> "))+E(o,D("auto_rescheduling"),'<input type="checkbox" name="auto_rescheduling" id="'+o+'" value="1">&nbsp;<label for="'+o+'">'+D("enable")+"</label> "))+E(r,D("is_trial"),'<input type="checkbox" name="istrial" id="'+r+'" value="1">&nbsp;<label for="'+r+'">'+D("enable")+"</label> "))+E(c,D("auxiliary_camera"),'<input type="checkbox" name="auxiliarycamera" id="'+c+'" value="1">&nbsp;<label for="'+c+'">'+D("enable")+"</label> "))+E(u,D("auxiliary_camera_mode"),'<select name="auxiliarycameramode" id="'+u+'" class="custom-select">  <option value="photo">'+D("auxiliary_camera_mode_photo")+'</option>  <option value="video">'+D("auxiliary_camera_mode_video")+"</option></select>"))+E(v,D("enable_secure_browser"),'<input type="checkbox" name="securebrowser" id="'+v+'" value="1">&nbsp;<label for="'+v+'">'+D("enable")+"</label> "))+E(L,D("secure_browser_level"),'<select name="securebrowserlevel" id="'+L+'" class="custom-select">  <option value="basic">'+D("secure_browser_level_basic")+'</option>  <option value="medium">'+D("secure_browser_level_medium")+'</option>  <option value="high">'+D("secure_browser_level_high")+"</option></select>"))+E(d,D("allowmultipledisplays"),'<label for="'+d+'"><input type="checkbox" name="allowmultipledisplays" id="'+d+'" value="1">&nbsp;'+D("enable")+"</label> "))+E(m,D("allowvirtualenvironment"),'<label for="'+m+'"><input type="checkbox" name="allowvirtualenvironment" id="'+m+'" value="1">&nbsp;'+D("enable")+"</label> "))+E(p,D("checkidphotoquality"),'<label for="'+p+'"><input type="checkbox" name="checkidphotoquality" id="'+p+'" value="1">&nbsp;'+D("enable")+"</label> "))+E(_,D("sendmanualwarningstolearner"),'<label for="'+_+'"><input type="checkbox" name="sendmanualwarningstolearner" id="'+_+'" value="1">&nbsp;'+D("enable")+"</label> "))+E(w,D("allowroomscanauxcamera"),'<label for="'+w+'"><input type="checkbox" name="allowroomscanauxcamera" id="'+w+'" value="1">&nbsp;'+D("enable")+"</label> "))+E(b,D("user_agreement_url"),'<input name="useragreementurl" id="'+b+'" class="form-control" value="" />'))+E(s,D("custom_rules"),'<textarea name="customrules" id="'+s+'" style="width: 100%" class="form-control"></textarea>'))+E(j,D("calculator"),'<select name="calculator" id="'+j+'" class="custom-select">  <option value="off">'+D("calculator_off")+'</option>  <option value="simple">'+D("calculator_simple")+'</option>  <option value="scientific">'+D("calculator_scientific")+"</option></select>"),H="",
this.streamsPresetOptions)H+='<option value="'+(W=this.streamsPresetOptions[U])+'">'+D("streamspreset_"+W)+"</option>";for(C in i=(i+=E(B,D("streamspreset"),'<select name="streamspreset" id="'+B+'" class="custom-select">'+H+"</select>"))+E(f,D("preliminary_check"),'<input type="checkbox" name="preliminarycheck" id="'+f+'" value="1">&nbsp;<label for="'+f+'">'+D("enable")+"</label> "),Y="",this.rules)Y+='<label for="'+($=a+"_"+C)+'" style="'+x+'"><input type="checkbox" name="'+C+'" id="'+$+'" value="'+C+'" >&nbsp;'+D(C)+"</label>";for(z in i+=E(null,D("rules"),'<div class="rules" style="white-space:nowrap">'+Y+"</div>"),q="",this.groups)q+='<label  style="'+x+'"><input value="'+(G=this.groups[z]).id+'" type="checkbox" name="proctoring-groups['+G.id+']">&nbsp;'+G.name+"</label>";for(N in q&&q.length&&(i+=E(null,D("select_groups"),'<div class="groups">'+q+"</div>")),i=(i+=E(g,D("forbidden_processes"),'<textarea name="forbiddenprocesses" id="'+g+'" style="width: 100%" class="form-control"></textarea><div class="text-muted">'+D("processes_list_hint")+"</div>"))+E(h,D("allowed_processes"),'<textarea name="allowedprocesses" id="'+h+'" style="width: 100%" class="form-control"></textarea><div class="text-muted">'+D("processes_list_hint")+"</div>"),J="",this.warnings)J+='<label for="'+(K=a+"_"+N)+'" style="'+x+'"><input type="checkbox" name="'+N+'" id="'+K+'" value="'+N+'" >&nbsp;'+D(N)+"</label>";for(T in Q="",this.scoring)Z='<input type="number" class="proctor-scoring-input" value=""step="0.01" name="'+T+'"id="scoring_'+(X=a+"_"+T)+'"min="'+this.scoring[T].min+'" max="'+this.scoring[T].max+'">',Q+=E(X,D("scoring_"+T),Z);if(I="",I=(I+=E(null,D("visible_warnings"),'<div class="warnings" style="white-space: nowrap" >'+me(J)+"</div>",!0))+E(null,D("scoring_params_header"),me(Q),!0),(n=fe.Node.create('<span class="availability_proctor-tabs" style="position:relative"></span>')).setHTML("<label><strong>"+D("title")+"</strong></label><br><br>"),O=fe.Node.create('<div style="position:absolute; top: 0; right: 0;" class="availability_proctor-tab-btns"></div>').appendTo(n),y=fe.Node.create('<a href="#" class="btn btn-primary">1</a>').appendTo(O),k=fe.Node.create('<a href="#" class="btn btn-secondary">2</a>').appendTo(O),F=fe.Node.create('<div class="tab_content">'+i+"</div>").appendTo(n),S=fe.Node.create('<div class="tab_content hidden">'+I+"</div>").appendTo(n),e.rules===undefined&&(e.rules=this.rules),e.warnings===undefined&&(e.warnings=this.warnings),e.scoring=e.scoring||{},e.sendmanualwarningstolearner===undefined&&(e.sendmanualwarningstolearner=!0),e.creating){for(P in this.defaults)if(R=this.defaults[P],"scoring"==P)for(A in R)e.scoring[A]=R[A]?parseFloat(R[A]):null;else if("rules"==P)for(ee in R)e.rules[ee]=R[ee];else if("warnings"==P)for(ae in R)e.warnings[ae]=!!R[ae];else"groups"==P?e.groups=R:e[P]=R;e.auxiliarycameramode||(e.auxiliarycameramode="video"),e.mode||(e.mode="online",e.scheduling_required=!0)}for(ne in e.duration!==undefined&&n.one("input[name=duration]").set("value",e.duration),e.mode!==undefined&&n.one("select[name=mode] option[value="+e.mode+"]").set("selected","selected"),e.identification&&n.one("select[name=identification] option[value="+e.identification+"]").set("selected","selected"),e.webcameramainview&&n.one("select[name=webcameramainview] option[value="+e.webcameramainview+"]").set("selected","selected"),e.auto_rescheduling!==undefined&&n.one("#"+o).set("checked",e.auto_rescheduling?"checked":null),e.istrial!==undefined&&(u=e.istrial?"checked":null,n.one("#"+r).set("checked",u)),e.auxiliarycamera!==undefined&&n.one("#"+c).set("checked",e.auxiliarycamera?"checked":null),e.auxiliarycameramode&&n.one("select[name=auxiliarycameramode] option[value="+e.auxiliarycameramode+"]").set("selected","selected"),e.securebrowser!==undefined&&n.one("#"+v).set("checked",e.securebrowser?"checked":null),e.scheduling_required!==undefined&&n.one("#"+l).set("checked",e.scheduling_required?"checked":null),e.allowmultipledisplays!==undefined&&n.one("#"+d).set("checked",e.allowmultipledisplays?"checked":null),e.allowvirtualenvironment!==undefined&&n.one("#"+m).set("checked",e.allowvirtualenvironment?"checked":null),e.checkidphotoquality!==undefined&&n.one("#"+p).set("checked",e.checkidphotoquality?"checked":null),e.sendmanualwarningstolearner!==undefined&&n.one("#"+_).set("checked",e.sendmanualwarningstolearner?"checked":null),e.preliminarycheck!==undefined&&n.one("#"+f).set("checked",e.preliminarycheck?"checked":null),e.calculator!==undefined&&n.one("select[name=calculator] option[value="+e.calculator+"]").set("selected","selected"),e.streamspreset!==undefined&&n.one("select[name=streamspreset] option[value="+e.streamspreset+"]").set("selected","selected"),e.securebrowserlevel&&n.one("select[name=securebrowserlevel] option[value="+e.securebrowserlevel+"]").set("selected","selected"),e.allowroomscanauxcamera!==undefined&&n.one("#"+w).set("checked",e.allowroomscanauxcamera?"checked":null),this.warnings)e.warnings[ne]===undefined&&(e.warnings[ne]=this.warnings[ne]);for(ie in e.warnings)e.warnings[ie]&&(te=n.one(".warnings input[name="+ie+"]"))&&te.set("checked","checked");for(le in e.rules)e.rules[le]&&(oe=n.one(".rules input[name="+le+"]"))&&oe.set("checked","checked");for(se in re=(re=e.groups instanceof Array?e.groups:[]).map(function(e){return parseInt(e)}),this.groups)V=this.groups[se],ce=-1<re.indexOf(parseInt(V.id)),V="proctoring-groups["+V.id+"]",(V=n.one('.groups input[name="'+V+'"]'))&&ce&&V.set("checked","checked");for(ue in e.scoring)isNaN(e.scoring[ue])||(de=n.one(".proctor-scoring-input[name="+ue+"]"))&&de.set("value",e.scoring[ue]);return e.customrules!==undefined&&n.one("#"+s).set("value",e.customrules),e.useragreementurl!==undefined&&n.one("#"+b).set("value",e.useragreementurl),e.forbiddenprocesses!==undefined&&n.one("#"+g).set("value",e.forbiddenprocesses),e.allowedprocesses!==undefined&&n.one("#"+h).set("value",e.allowedprocesses),n.delegate("valuechange",function(){pe(function(){
M.core_availability.form.update()})},"input,textarea,select"),n.delegate("click",function(){pe(function(){M.core_availability.form.update()})},"input[type=checkbox]"),n.delegate("valuechange",function(){var e,a;e=["normal","identification"],a=n.one("select[name=mode]").get("value").trim(),a=0<=e.indexOf(a),n.one("#"+l).set("checked",a)},"#"+t),y.on("click",function(e){e.preventDefault(),ve(1)}),k.on("click",function(e){e.preventDefault(),ve(2)}),n.delegate("click",function(e){var a;e.preventDefault(),e=e.target,(a=e.next()).hasClass("hidden")?(a.removeClass("hidden"),e.setContent(e.getAttribute("data-less"))):(a.addClass("hidden"),e.setContent(e.getAttribute("data-more")))},".proctor-moreless"),n},M.availability_proctor.form.fillValue=function(n,e){var a,i;n.duration=e.one("input[name=duration]").get("value").trim(),n.mode=e.one("select[name=mode]").get("value").trim(),n.identification=e.one("select[name=identification]").get("value").trim(),n.webcameramainview=e.one("select[name=webcameramainview]").get("value").trim(),n.auto_rescheduling=e.one("input[name=auto_rescheduling]").get("checked"),n.scheduling_required=e.one("input[name=scheduling_required]").get("checked"),n.istrial=e.one("input[name=istrial]").get("checked"),n.customrules=e.one("textarea[name=customrules]").get("value").trim(),n.useragreementurl=e.one("input[name=useragreementurl]").get("value").trim(),n.auxiliarycamera=e.one("input[name=auxiliarycamera]").get("checked"),n.auxiliarycameramode=e.one("select[name=auxiliarycameramode]").get("value").trim(),n.securebrowser=e.one("input[name=securebrowser]").get("checked"),n.securebrowserlevel=e.one("select[name=securebrowserlevel]").get("value").trim(),n.allowmultipledisplays=e.one("input[name=allowmultipledisplays]").get("checked"),n.allowvirtualenvironment=e.one("input[name=allowvirtualenvironment]").get("checked"),n.sendmanualwarningstolearner=e.one("input[name=sendmanualwarningstolearner]").get("checked"),n.checkidphotoquality=e.one("input[name=checkidphotoquality]").get("checked"),n.calculator=e.one("select[name=calculator]").get("value").trim(),n.streamspreset=e.one("select[name=streamspreset]").get("value").trim(),n.allowedprocesses=e.one("textarea[name=allowedprocesses]").get("value").trim(),n.forbiddenprocesses=e.one("textarea[name=forbiddenprocesses]").get("value").trim(),n.allowroomscanauxcamera=e.one("input[name=allowroomscanauxcamera]").get("checked"),n.preliminarycheck=e.one("input[name=preliminarycheck]").get("checked"),n.rules={},a=e.all(".rules input"),fe.each(a,function(e){i=e.get("value"),!0===e.get("checked")?n.rules[i]=!0:n.rules[i]=!1}),n.warnings={},a=e.all(".warnings input"),fe.each(a,function(e){i=e.get("value"),!0===e.get("checked")?n.warnings[i]=!0:n.warnings[i]=!1}),n.scoring={},a=e.all(".proctor-scoring-input"),fe.each(a,function(e){i=e.get("name");e=e.get("value").trim();0<e.length?n.scoring[i]=parseFloat(e):n.scoring[i]=null}),n.groups=[],a=e.all(".groups input"),fe.each(a,function(e){var a=e.get("value");!0===e.get("checked")&&n.groups.push(a)})},M.availability_proctor.form.fillErrors=function(e,a){var n={};this.fillValue(n,a),n.duration!==undefined&&new RegExp("^\\d+$").test(n.duration)&&n.duration%30==0||e.push("availability_proctor:error_setduration")}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});