YUI.add("moodle-availability_proctor-form",function(e,t){M.availability_proctor=M.availability_proctor||{},M.availability_proctor.form=e.Object(M.core_availability.plugin),M.availability_proctor.form.rules=null,M.availability_proctor.form.initInner=function(e,t,n){this.rules=e,this.warnings=t,this.scoring=n},M.availability_proctor.form.instId=0,M.availability_proctor.form.getNode=function(t){function N(e,t){return t=t||"availability_proctor",M.util.get_string(e,t)}function C(e){var t=N("showmore","core_form"),n=N("showless","core_form");return'<a href="#" class="proctor-moreless" data-more="'+t+'" data-less="'+n+'">'+t+'</a><div class="hidden col-md-12">'+e+"</div>"}function k(e){var t=e.next(),n=t.hasClass("hidden");n?(t.removeClass("hidden"),e.setContent(e.getAttribute("data-less"))):(t.addClass("hidden"),e.setContent(e.getAttribute("data-more")))}function L(e,t,n,r){var i=r?10:5,s=r?10:7;return'<span class="availability-group form-group mb-2"><div class="col-md-'+i+' col-form-label d-flex pb-0 pr-md-0">'+'  <label for="'+e+'">'+t+"</label>"+"</div>"+'<div class="col-md-'+s+' form-inline align-items-start felement">'+n+"</div>"+"</span>"}function A(){var e=["normal","identification"],t=r.one("select[name=mode]").get("value").trim(),n=e.indexOf(t)>=0;r.one("#"+a).set("checked",n)}function O(e){setTimeout(e,0)}function _(e){e==1?(E.addClass("btn-primary"),E.removeClass("btn-secondary"),S.addClass("btn-secondary"),S.removeClass("btn-primary"),x.removeClass("hidden"),T.addClass("hidden")):(S.addClass("btn-primary"),S.removeClass("btn-secondary"),E.addClass("btn-secondary"),E.removeClass("btn-primary"),x.addClass("hidden"),T.removeClass("hidden"))}M.availability_proctor.form.instId+=1;var n,r,i,s="proctor"+M.availability_proctor.form.instId,o=s+"_duration",u=s+"_mode",a=s+"_schedulingRequired",f=s+"_autoRescheduling",l=s+"_isTrial",c=s+"_identification",h=s+"_customRules",p=s+"_noProtection",d=s+"_auxCamera",v=s+"_ldb",m=s+"_biometryEnabled",g=s+"_biometrySkipfail",y=s+"_biometryFlow",b=s+"_biometryTheme",w=s+"userAgreement",E,S,x,T;n=L(o,N("duration"),'<input type="text" name="duration" id="'+o+'" class="form-control">'),n+=L(u,N("proctoring_mode"),'<select name="mode" id="'+u+'" class="custom-select">'+'  <option value="online">'+N("online_mode")+"</option>"+'  <option value="identification">'+N("identification_mode")+"</option>"+'  <option value="offline">'+N("offline_mode")+"</option>"+'  <option value="auto">'+N("auto_mode")+"</option>"+"</select>"),n+=L(c,N("identification"),'<select name="identification" id="'+c+'" class="custom-select">'+'  <option value="passport">'+N("passport_identification")+"</option>"+'  <option value="face">'+N("face_identification")+"</option>"+'  <option value="face_and_passport">'+N("face_passport_identification")+"</option>"+'  <option value="skip">'+N("skip_identification")+"</option>"+"</select>"),n+=L(a,N("scheduling_required"),'<input type="checkbox" name="scheduling_required" id="'+a+'" value="1">&nbsp;'+'<label for="'+a+'">'+N("enable")+"</label> "),n+=L(f,N("auto_rescheduling"),'<input type="checkbox" name="auto_rescheduling" id="'+f+'" value="1">&nbsp;'+'<label for="'+f+'">'+N("enable")+"</label> "),n+=L(l,N("is_trial"),'<input type="checkbox" name="istrial" id="'+l+'" value="1">&nbsp;'+'<label for="'+l+'">'+N("enable")+"</label> "),n+=L(p,N("noprotection"),'<input type="checkbox" name="noprotection" id="'+p+'" value="1">&nbsp;'+'<label for="'+p+'">'+N("enable")+"</label> "),n+=L(d,N("auxiliary_camera"),'<input type="checkbox" name="auxiliarycamera" id="'+d+'" value="1">&nbsp;'+'<label for="'+d+'">'+N("enable")+"</label> "),n+=L(v,N("enable_ldb"),'<input type="checkbox" name="ldb" id="'+v+'" value="1">&nbsp;'+'<label for="'+v+'">'+N("enable")+"</label> "),n+=L(w,N("user_agreement_url"),'<input name="useragreementurl" id="'+w+'" class="form-control" value="" />'),n+=L(h,N("custom_rules"),'<textarea name="customrules" id="'+h+'" style="width: 100%" class="form-control"></textarea>');var D="";for(var P in this.rules){var H=s+"_"+P;D+='<br><input type="checkbox" name="'+P+'" id="'+H+'" value="'+P+'" >&nbsp;',D+='<label for="'+H+'" style="white-space: break-spaces">'+N(P)+"</label>"}n+=L(null,N("rules"),'<div class="rules" style="white-space:nowrap">'+D+"</div>");var B="";for(var j in this.warnings){var F=s+"_"+j;B+='<input type="checkbox" name="'+j+'" id="'+F+'" value="'+j+'" >&nbsp;',B+='<label for="'+F+'" style="white-space: break-spaces">'+N(j)+"</label><br>"}var I="";for(var q in this.scoring){var R=s+"_"+q,U=this.scoring[q].min,z=this.scoring[q].max,W='<input type="number" class="proctor-scoring-input" value=""step="0.01" name="'+q+'"'+'id="scoring_'+R+'"'+'min="'+U+'" max="'+z+'">';I+=L(R,N("scoring_"+q),W)}var X="";X+=L(m,N("biometry_enabled"),'<input type="checkbox" name="biometryenabled" id="'+m+'" value="1">&nbsp;'+'<label for="'+m+'">'+N("enable")+"</label> "),X+=L(g,N("biometry_skipfail"),'<input type="checkbox" name="biometryskipfail" id="'+g+'" value="1">&nbsp;'+'<label for="'+g+'">'+N("enable")+"</label> "),X+=L(y,N("biometry_flow"),'<input type="text" name="biometryflow" id="'+y+'" class="form-control">'),X+=L(b,N("biometry_theme"),'<input type="text" name="biometrytheme" id="'+b+'" class="form-control">');var V="";V+=L(null,N("visible_warnings"),'<div class="warnings" style="white-space: nowrap" >'+C(B)+"</div>",!0),V+=L(null,N("scoring_params_header"),C(I),!0),V+=L(null,N("biometry_header"),C(X),!0),r=e.Node.create('<span class="availability_proctor-tabs" style="position:relative"></span>'),r.setHTML("<label><strong>"+N("title")+"</strong></label><br><br>");var $=e.Node.create('<div style="position:absolute; top: 0; right: 0;" class="availability_proctor-tab-btns"></div>').appendTo(r);E=e.Node.create('<a href="#" class="btn btn-primary">1</a>').appendTo($),S=e.Node.create('<a href="#" class="btn btn-secondary">2</a>').appendTo($),x=e.Node.create('<div class="tab_content">'+n+"</div>").appendTo(r),T=e.Node.create('<div class="tab_content hidden">'+
V+"</div>").appendTo(r),t.creating&&(t.mode="online",t.scheduling_required=!0),t.duration!==undefined&&r.one("input[name=duration]").set("value",t.duration),t.mode!==undefined&&r.one("select[name=mode] option[value="+t.mode+"]").set("selected","selected"),t.identification!==undefined&&r.one("select[name=identification] option[value="+t.identification+"]").set("selected","selected"),t.auto_rescheduling!==undefined&&(i=t.auto_rescheduling?"checked":null,r.one("#"+f).set("checked",i)),t.noprotection!==undefined&&(i=t.noprotection?"checked":null,r.one("#"+p).set("checked",i)),t.istrial!==undefined&&(i=t.istrial?"checked":null,r.one("#"+l).set("checked",i)),t.auxiliarycamera!==undefined&&(i=t.auxiliarycamera?"checked":null,r.one("#"+d).set("checked",i)),t.ldb!==undefined&&(i=t.ldb?"checked":null,r.one("#"+v).set("checked",i)),t.scheduling_required!==undefined&&(i=t.scheduling_required?"checked":null,r.one("#"+a).set("checked",i)),t.rules===undefined&&(t.rules=this.rules),t.biometryenabled!==undefined&&(i=t.biometryenabled?"checked":null,r.one("#"+m).set("checked",i)),t.biometryskipfail!==undefined&&(i=t.biometryskipfail?"checked":null,r.one("#"+g).set("checked",i)),t.biometryflow!==undefined&&r.one("#"+y).set("value",t.biometryflow),t.biometrytheme!==undefined&&r.one("#"+b).set("value",t.biometrytheme);if(t.warnings===undefined)t.warnings=this.warnings;else{var J=t.warnings;t.warnings=this.warnings;for(var K in J)t.warnings[K]=J[K]}for(var Q in t.rules)if(t.rules[Q]){var G=r.one(".rules input[name="+Q+"]");G&&G.set("checked","checked")}for(var Z in t.warnings)if(t.warnings[Z]){var et=r.one(".warnings input[name="+Z+"]");et&&et.set("checked","checked")}t.scoring=t.scoring||{};for(var tt in t.scoring)if(!isNaN(t.scoring[tt])){var nt=r.one(".proctor-scoring-input[name="+tt+"]");nt&&nt.set("value",t.scoring[tt])}return t.customrules!==undefined&&r.one("#"+h).set("value",t.customrules),t.useragreementurl!==undefined&&r.one("#"+w).set("value",t.useragreementurl),r.delegate("valuechange",function(){O(function(){M.core_availability.form.update()})},"input,textarea,select"),r.delegate("click",function(){O(function(){M.core_availability.form.update()})},"input[type=checkbox]"),r.delegate("valuechange",function(){A()},"#"+u),E.on("click",function(e){e.preventDefault(),_(1)}),S.on("click",function(e){e.preventDefault(),_(2)}),r.delegate("click",function(e){e.preventDefault(),k(e.target)},".proctor-moreless"),r},M.availability_proctor.form.fillValue=function(t,n){var r,i,s,o;t.duration=n.one("input[name=duration]").get("value").trim(),t.mode=n.one("select[name=mode]").get("value").trim(),t.identification=n.one("select[name=identification]").get("value").trim(),t.auto_rescheduling=n.one("input[name=auto_rescheduling]").get("checked"),t.scheduling_required=n.one("input[name=scheduling_required]").get("checked"),t.istrial=n.one("input[name=istrial]").get("checked"),t.customrules=n.one("textarea[name=customrules]").get("value").trim(),t.noprotection=n.one("input[name=noprotection]").get("checked"),t.useragreementurl=n.one("input[name=useragreementurl]").get("value").trim(),t.auxiliarycamera=n.one("input[name=auxiliarycamera]").get("checked"),t.ldb=n.one("input[name=ldb]").get("checked"),t.biometryenabled=n.one("input[name=biometryenabled]").get("checked"),t.biometryskipfail=n.one("input[name=biometryskipfail]").get("checked"),t.biometryflow=n.one("input[name=biometryflow]").get("value").trim(),t.biometrytheme=n.one("input[name=biometrytheme]").get("value").trim(),t.rules={},r=n.all(".rules input"),e.each(r,function(e){o=e.get("value"),e.get("checked")===!0?t.rules[o]=!0:t.rules[o]=!1}),t.warnings={},i=n.all(".warnings input"),e.each(i,function(e){o=e.get("value"),e.get("checked")===!0?t.warnings[o]=!0:t.warnings[o]=!1}),t.scoring={},s=n.all(".proctor-scoring-input"),e.each(s,function(e){o=e.get("name");var n=e.get("value").trim();n.length>0?t.scoring[o]=parseFloat(n):t.scoring[o]=null})},M.availability_proctor.form.fillErrors=function(e,t){var n={};this.fillValue(n,t),(n.duration===undefined||!(new RegExp("^\\d+$")).test(n.duration)||n.duration%30!==0)&&e.push("availability_proctor:error_setduration")}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});
