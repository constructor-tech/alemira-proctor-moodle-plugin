YUI.add("moodle-availability_proctor-form",function(ge,e){M.availability_proctor=M.availability_proctor||{},M.availability_proctor.form=ge.Object(M.core_availability.plugin),M.availability_proctor.form.rules=null,M.availability_proctor.form.initInner=function(e,a,n,i,t,o){this.rules=e,this.warnings=a,this.scoring=n,this.defaults=t,this.groups=o,this.streamsPresetOptions=i},M.availability_proctor.form.instId=0,M.availability_proctor.form.getNode=function(e){var n,a,i,t,o,l,r,s,c,u,d,m,p,b,f,v,h,g,_,F,L,S,j,y,w,k,x,B,H,U,W,Y,$,z,C,G,q,J,K,Q,N,X,Z,T,ee,ae,I,O,P,R,A,ne,ie,te,oe,le,re,se,ce,ue,de,me,E,pe,be;function V(e,a){return a=a||"availability_proctor",M.util.get_string(e,a)}function fe(e){var a=V("showmore","core_form");return'<a href="#" class="proctor-moreless" data-more="'+a+'" data-less="'+V("showless","core_form")+'">'+a+'</a><div class="hidden col-md-12">'+e+"</div>"}function D(e,a,n,i){return'<span class="availability-group form-group mb-2 d-flex '+(i?"flex-column":"flex-row")+'"><div class="col-md-'+(i?12:5)+' col-form-label d-flex pb-0 pl-md-0">  <label for="'+e+'">'+a+'</label></div><div class="col-md-'+(i?12:7)+' form-inline align-items-start felement pl-md-0">'+n+"</div></span>"}function ve(e){setTimeout(e,0)}function he(e){1==e?(k.addClass("btn-primary"),k.removeClass("btn-secondary"),x.addClass("btn-secondary"),x.removeClass("btn-primary"),B.removeClass("hidden"),H.addClass("hidden")):(x.addClass("btn-primary"),x.removeClass("btn-secondary"),k.addClass("btn-secondary"),k.removeClass("btn-primary"),B.addClass("hidden"),H.removeClass("hidden"))}for(Y in M.availability_proctor.form.instId+=1,t=(a="proctor"+M.availability_proctor.form.instId)+"_mode",o=a+"_schedulingRequired",l=a+"_autoRescheduling",r=a+"_isTrial",I=a+"_identification",s=a+"_customRules",c=a+"_auxCamera",P=a+"_auxCameraMode",u=a+"_allowmultipledisplays",d=a+"_allowvirtualenvironment",m=a+"_checkidphotoquality",p=a+"_secureBrowser",b=a+"_secureBrowserLevel",f=a+"_biometryEnabled",v=a+"_biometrySkipfail",h=a+"_biometryFlow",g=a+"_biometryTheme",_=a+"_userAgreement",O=a+"_webCameraMainView",F=a+"_calculator",L=a+"_streamsPreset",S=a+"_allowedProcesses",j=a+"_forbiddenProcesses",y=a+"_sendManualWarningsToLearner",w=a+"_allowRoomScanAuxCamera",U="white-space: break-spaces; display:flex; align-items: baseline; justify-content: flex-start;",i=D(i=a+"_duration",V("duration"),'<input type="text" name="duration" id="'+i+'" class="form-control">'),i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i+=D(t,V("proctoring_mode"),'<select name="mode" id="'+t+'" class="custom-select">  <option value="online">'+V("online_mode")+'</option>  <option value="identification">'+V("identification_mode")+'</option>  <option value="offline">'+V("offline_mode")+'</option>  <option value="auto">'+V("auto_mode")+"</option></select>"))+D(I,V("identification"),'<select name="identification" id="'+I+'" class="custom-select">  <option value="passport">'+V("passport_identification")+'</option>  <option value="face">'+V("face_identification")+'</option>  <option value="face_and_passport">'+V("face_passport_identification")+'</option>  <option value="skip">'+V("skip_identification")+"</option></select>"))+D(O,V("web_camera_main_view"),'<select name="webcameramainview" id="'+O+'" class="custom-select">  <option value="front">'+V("web_camera_main_view_front")+'</option>  <option value="side">'+V("web_camera_main_view_side")+"</option></select>"))+D(o,V("scheduling_required"),'<input type="checkbox" name="scheduling_required" id="'+o+'" value="1">&nbsp;<label for="'+o+'">'+V("enable")+"</label> "))+D(l,V("auto_rescheduling"),'<input type="checkbox" name="auto_rescheduling" id="'+l+'" value="1">&nbsp;<label for="'+l+'">'+V("enable")+"</label> "))+D(r,V("is_trial"),'<input type="checkbox" name="istrial" id="'+r+'" value="1">&nbsp;<label for="'+r+'">'+V("enable")+"</label> "))+D(c,V("auxiliary_camera"),'<input type="checkbox" name="auxiliarycamera" id="'+c+'" value="1">&nbsp;<label for="'+c+'">'+V("enable")+"</label> "))+D(P,V("auxiliary_camera_mode"),'<select name="auxiliarycameramode" id="'+P+'" class="custom-select">  <option value="photo">'+V("auxiliary_camera_mode_photo")+'</option>  <option value="video">'+V("auxiliary_camera_mode_video")+"</option></select>"))+D(p,V("enable_secure_browser"),'<input type="checkbox" name="securebrowser" id="'+p+'" value="1">&nbsp;<label for="'+p+'">'+V("enable")+"</label> "))+D(b,V("secure_browser_level"),'<select name="securebrowserlevel" id="'+b+'" class="custom-select">  <option value="basic">'+V("secure_browser_level_basic")+'</option>  <option value="medium">'+V("secure_browser_level_medium")+'</option>  <option value="high">'+V("secure_browser_level_high")+"</option></select>"))+D(u,V("allowmultipledisplays"),'<label for="'+u+'"><input type="checkbox" name="allowmultipledisplays" id="'+u+'" value="1">&nbsp;'+V("enable")+"</label> "))+D(d,V("allowvirtualenvironment"),'<label for="'+d+'"><input type="checkbox" name="allowvirtualenvironment" id="'+d+'" value="1">&nbsp;'+V("enable")+"</label> "))+D(m,V("checkidphotoquality"),'<label for="'+m+'"><input type="checkbox" name="checkidphotoquality" id="'+m+'" value="1">&nbsp;'+V("enable")+"</label> "))+D(y,V("sendmanualwarningstolearner"),'<label for="'+y+'"><input type="checkbox" name="sendmanualwarningstolearner" id="'+y+'" value="1">&nbsp;'+V("enable")+"</label> "))+D(w,V("allowroomscanauxcamera"),'<label for="'+w+'"><input type="checkbox" name="allowroomscanauxcamera" id="'+w+'" value="1">&nbsp;'+V("enable")+"</label> "))+D(_,V("user_agreement_url"),'<input name="useragreementurl" id="'+_+'" class="form-control" value="" />'))+D(s,V("custom_rules"),'<textarea name="customrules" id="'+s+'" style="width: 100%" class="form-control"></textarea>'))+D(F,V("calculator"),'<select name="calculator" id="'+F+'" class="custom-select">  <option value="off">'+V("calculator_off")+'</option>  <option value="simple">'+V("calculator_simple"
)+'</option>  <option value="scientific">'+V("calculator_scientific")+"</option></select>"),W="",this.streamsPresetOptions)W+='<option value="'+($=this.streamsPresetOptions[Y])+'">'+V("streamspreset_"+$)+"</option>";for(C in i+=D(L,V("streamspreset"),'<select name="streamspreset" id="'+L+'" class="custom-select">'+W+"</select>"),z="",this.rules)z+='<label for="'+(G=a+"_"+C)+'" style="'+U+'"><input type="checkbox" name="'+C+'" id="'+G+'" value="'+C+'" >&nbsp;'+V(C)+"</label>";for(J in i+=D(null,V("rules"),'<div class="rules" style="white-space:nowrap">'+z+"</div>"),q="",this.groups)q+='<label  style="'+U+'"><input value="'+(K=this.groups[J]).id+'" type="checkbox" name="proctoring-groups['+K.id+']">&nbsp;'+K.name+"</label>";for(N in q&&q.length&&(i+=D(null,V("select_groups"),'<div class="groups">'+q+"</div>")),i=(i+=D(j,V("forbidden_processes"),'<textarea name="forbiddenprocesses" id="'+j+'" style="width: 100%" class="form-control"></textarea><div class="text-muted">'+V("processes_list_hint")+"</div>"))+D(S,V("allowed_processes"),'<textarea name="allowedprocesses" id="'+S+'" style="width: 100%" class="form-control"></textarea><div class="text-muted">'+V("processes_list_hint")+"</div>"),Q="",this.warnings)Q+='<label for="'+(X=a+"_"+N)+'" style="'+U+'"><input type="checkbox" name="'+N+'" id="'+X+'" value="'+N+'" >&nbsp;'+V(N)+"</label>";for(T in Z="",this.scoring)ae='<input type="number" class="proctor-scoring-input" value=""step="0.01" name="'+T+'"id="scoring_'+(ee=a+"_"+T)+'"min="'+this.scoring[T].min+'" max="'+this.scoring[T].max+'">',Z+=D(ee,V("scoring_"+T),ae);if(I="",I=(I=(I=(I+=D(f,V("biometry_enabled"),'<input type="checkbox" name="biometryenabled" id="'+f+'" value="1">&nbsp;<label for="'+f+'">'+V("enable")+"</label> "))+D(v,V("biometry_skipfail"),'<input type="checkbox" name="biometryskipfail" id="'+v+'" value="1">&nbsp;<label for="'+v+'">'+V("enable")+"</label> "))+D(h,V("biometry_flow"),'<input type="text" name="biometryflow" id="'+h+'" class="form-control">'))+D(g,V("biometry_theme"),'<input type="text" name="biometrytheme" id="'+g+'" class="form-control">'),O="",O=(O=(O+=D(null,V("visible_warnings"),'<div class="warnings" style="white-space: nowrap" >'+fe(Q)+"</div>",!0))+D(null,V("scoring_params_header"),fe(Z),!0))+D(null,V("biometry_header"),fe(I),!0),(n=ge.Node.create('<span class="availability_proctor-tabs" style="position:relative"></span>')).setHTML("<label><strong>"+V("title")+"</strong></label><br><br>"),P=ge.Node.create('<div style="position:absolute; top: 0; right: 0;" class="availability_proctor-tab-btns"></div>').appendTo(n),k=ge.Node.create('<a href="#" class="btn btn-primary">1</a>').appendTo(P),x=ge.Node.create('<a href="#" class="btn btn-secondary">2</a>').appendTo(P),B=ge.Node.create('<div class="tab_content">'+i+"</div>").appendTo(n),H=ge.Node.create('<div class="tab_content hidden">'+O+"</div>").appendTo(n),e.rules===undefined&&(e.rules=this.rules),e.warnings===undefined&&(e.warnings=this.warnings),e.scoring=e.scoring||{},e.sendmanualwarningstolearner===undefined&&(e.sendmanualwarningstolearner=!0),e.creating){for(R in this.defaults)if(A=this.defaults[R],"scoring"==R)for(ne in A)e.scoring[ne]=A[ne]?parseFloat(A[ne]):null;else if("rules"==R)for(ie in A)e.rules[ie]=A[ie];else if("warnings"==R)for(te in A)e.warnings[te]=!!A[te];else"groups"==R?e.groups=A:e[R]=A;e.auxiliarycameramode||(e.auxiliarycameramode="video"),e.mode||(e.mode="online",e.scheduling_required=!0)}for(oe in e.duration!==undefined&&n.one("input[name=duration]").set("value",e.duration),e.mode!==undefined&&n.one("select[name=mode] option[value="+e.mode+"]").set("selected","selected"),e.identification&&n.one("select[name=identification] option[value="+e.identification+"]").set("selected","selected"),e.webcameramainview&&n.one("select[name=webcameramainview] option[value="+e.webcameramainview+"]").set("selected","selected"),e.auto_rescheduling!==undefined&&n.one("#"+l).set("checked",e.auto_rescheduling?"checked":null),e.istrial!==undefined&&(b=e.istrial?"checked":null,n.one("#"+r).set("checked",b)),e.auxiliarycamera!==undefined&&n.one("#"+c).set("checked",e.auxiliarycamera?"checked":null),e.auxiliarycameramode&&n.one("select[name=auxiliarycameramode] option[value="+e.auxiliarycameramode+"]").set("selected","selected"),e.securebrowser!==undefined&&n.one("#"+p).set("checked",e.securebrowser?"checked":null),e.scheduling_required!==undefined&&n.one("#"+o).set("checked",e.scheduling_required?"checked":null),e.allowmultipledisplays!==undefined&&n.one("#"+u).set("checked",e.allowmultipledisplays?"checked":null),e.allowvirtualenvironment!==undefined&&n.one("#"+d).set("checked",e.allowvirtualenvironment?"checked":null),e.checkidphotoquality!==undefined&&n.one("#"+m).set("checked",e.checkidphotoquality?"checked":null),e.sendmanualwarningstolearner!==undefined&&n.one("#"+y).set("checked",e.sendmanualwarningstolearner?"checked":null),e.biometryenabled!==undefined&&n.one("#"+f).set("checked",e.biometryenabled?"checked":null),e.biometryskipfail!==undefined&&n.one("#"+v).set("checked",e.biometryskipfail?"checked":null),e.biometryflow!==undefined&&n.one("#"+h).set("value",e.biometryflow),e.biometrytheme!==undefined&&n.one("#"+g).set("value",e.biometrytheme),e.calculator!==undefined&&n.one("select[name=calculator] option[value="+e.calculator+"]").set("selected","selected"),e.streamspreset!==undefined&&n.one("select[name=streamspreset] option[value="+e.streamspreset+"]").set("selected","selected"),e.securebrowserlevel&&n.one("select[name=securebrowserlevel] option[value="+e.securebrowserlevel+"]").set("selected","selected"),e.allowroomscanauxcamera!==undefined&&n.one("#"+w).set("checked",e.allowroomscanauxcamera?"checked":null),this.warnings)e.warnings[oe]===undefined&&(e.warnings[oe]=this.warnings[oe]);for(le in e.warnings)e.warnings[le]&&(re=n.one(".warnings input[name="+le+"]"))&&re.set("checked","checked");for(se in e.rules)e.rules[se]&&(ce=n.one(".rules input[name="+se+"]"))&&ce.set("checked","checked");for(
de in ue=(ue=e.groups instanceof Array?e.groups:[]).map(function(e){return parseInt(e)}),this.groups)E=this.groups[de],me=-1<ue.indexOf(parseInt(E.id)),E="proctoring-groups["+E.id+"]",(E=n.one('.groups input[name="'+E+'"]'))&&me&&E.set("checked","checked");for(pe in e.scoring)isNaN(e.scoring[pe])||(be=n.one(".proctor-scoring-input[name="+pe+"]"))&&be.set("value",e.scoring[pe]);return e.customrules!==undefined&&n.one("#"+s).set("value",e.customrules),e.useragreementurl!==undefined&&n.one("#"+_).set("value",e.useragreementurl),e.forbiddenprocesses!==undefined&&n.one("#"+j).set("value",e.forbiddenprocesses),e.allowedprocesses!==undefined&&n.one("#"+S).set("value",e.allowedprocesses),n.delegate("valuechange",function(){ve(function(){M.core_availability.form.update()})},"input,textarea,select"),n.delegate("click",function(){ve(function(){M.core_availability.form.update()})},"input[type=checkbox]"),n.delegate("valuechange",function(){var e,a;e=["normal","identification"],a=n.one("select[name=mode]").get("value").trim(),a=0<=e.indexOf(a),n.one("#"+o).set("checked",a)},"#"+t),k.on("click",function(e){e.preventDefault(),he(1)}),x.on("click",function(e){e.preventDefault(),he(2)}),n.delegate("click",function(e){var a;e.preventDefault(),e=e.target,(a=e.next()).hasClass("hidden")?(a.removeClass("hidden"),e.setContent(e.getAttribute("data-less"))):(a.addClass("hidden"),e.setContent(e.getAttribute("data-more")))},".proctor-moreless"),n},M.availability_proctor.form.fillValue=function(n,e){var a,i;n.duration=e.one("input[name=duration]").get("value").trim(),n.mode=e.one("select[name=mode]").get("value").trim(),n.identification=e.one("select[name=identification]").get("value").trim(),n.webcameramainview=e.one("select[name=webcameramainview]").get("value").trim(),n.auto_rescheduling=e.one("input[name=auto_rescheduling]").get("checked"),n.scheduling_required=e.one("input[name=scheduling_required]").get("checked"),n.istrial=e.one("input[name=istrial]").get("checked"),n.customrules=e.one("textarea[name=customrules]").get("value").trim(),n.useragreementurl=e.one("input[name=useragreementurl]").get("value").trim(),n.auxiliarycamera=e.one("input[name=auxiliarycamera]").get("checked"),n.auxiliarycameramode=e.one("select[name=auxiliarycameramode]").get("value").trim(),n.securebrowser=e.one("input[name=securebrowser]").get("checked"),n.securebrowserlevel=e.one("select[name=securebrowserlevel]").get("value").trim(),n.allowmultipledisplays=e.one("input[name=allowmultipledisplays]").get("checked"),n.allowvirtualenvironment=e.one("input[name=allowvirtualenvironment]").get("checked"),n.sendmanualwarningstolearner=e.one("input[name=sendmanualwarningstolearner]").get("checked"),n.checkidphotoquality=e.one("input[name=checkidphotoquality]").get("checked"),n.calculator=e.one("select[name=calculator]").get("value").trim(),n.streamspreset=e.one("select[name=streamspreset]").get("value").trim(),n.allowedprocesses=e.one("textarea[name=allowedprocesses]").get("value").trim(),n.forbiddenprocesses=e.one("textarea[name=forbiddenprocesses]").get("value").trim(),n.allowroomscanauxcamera=e.one("input[name=allowroomscanauxcamera]").get("checked"),n.biometryenabled=e.one("input[name=biometryenabled]").get("checked"),n.biometryskipfail=e.one("input[name=biometryskipfail]").get("checked"),n.biometryflow=e.one("input[name=biometryflow]").get("value").trim(),n.biometrytheme=e.one("input[name=biometrytheme]").get("value").trim(),n.rules={},a=e.all(".rules input"),ge.each(a,function(e){i=e.get("value"),!0===e.get("checked")?n.rules[i]=!0:n.rules[i]=!1}),n.warnings={},a=e.all(".warnings input"),ge.each(a,function(e){i=e.get("value"),!0===e.get("checked")?n.warnings[i]=!0:n.warnings[i]=!1}),n.scoring={},a=e.all(".proctor-scoring-input"),ge.each(a,function(e){i=e.get("name");e=e.get("value").trim();0<e.length?n.scoring[i]=parseFloat(e):n.scoring[i]=null}),n.groups=[],a=e.all(".groups input"),ge.each(a,function(e){var a=e.get("value");!0===e.get("checked")&&n.groups.push(a)})},M.availability_proctor.form.fillErrors=function(e,a){var n={};this.fillValue(n,a),n.duration!==undefined&&new RegExp("^\\d+$").test(n.duration)&&n.duration%30==0||e.push("availability_proctor:error_setduration")}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});