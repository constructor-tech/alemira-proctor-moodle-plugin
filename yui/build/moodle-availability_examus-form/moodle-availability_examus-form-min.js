YUI.add("moodle-availability_examus-form",function(e,t){M.availability_examus=M.availability_examus||{},M.availability_examus.form=e.Object(M.core_availability.plugin),M.availability_examus.form.rules=null,M.availability_examus.form.initInner=function(e,t){this.rules=e,this.groups=t},M.availability_examus.form.instId=0,M.availability_examus.form.getNode=function(t){function n(e){return M.util.get_string(e,"availability_examus")}var r,i,s,o;M.availability_examus.form.instId+=1;var u="examus"+M.availability_examus.form.instId,a=u+"_duration",f=u+"_mode",l=u+"_schedulingRequired",c=u+"_autoRescheduling";r="<label><strong>"+n("title")+"</strong></label><br><br>",r+='<label for="'+a+'">'+n("duration")+"</label> ",r+='<input type="text" name="duration" id="'+a+'">',r+='<br><label for="'+f+'">'+n("mode")+"</label> ",r+='<select name="mode" id="'+f+'">',r+='  <option value="normal">'+n("normal_mode")+"</option>",r+='  <option value="identification">'+n("identification_mode")+"</option>",r+='  <option value="olympics">'+n("olympics_mode")+"</option>",r+="</select>",r+='<br><label for="'+l+'">'+n("scheduling_required")+"</label> ",r+='<input type="checkbox" name="scheduling_required" id="'+l+'" value="1">&nbsp;',r+='<label for="'+l+'">'+n("enable")+"</label> ",r+='<br><label for="'+c+'">'+n("auto_rescheduling")+"</label> ",r+='<input type="checkbox" name="auto_rescheduling" id="'+c+'" value="1">&nbsp;',r+='<label for="'+c+'">'+n("enable")+"</label> ",r+='<div class="rules" style="padding-bottom:20px">',r+="<label>"+n("rules")+"</label> ";for(var h in this.rules){var p=u+"_"+h;r+='  <br><input type="checkbox" name="'+h+'" id="'+p+'" value="'+h+'" >',r+='  <label for="'+p+'">'+n(h)+"</label>"}r+="</div>";if(this.groups){r+='<div class="groups">',r+="<label>"+n("select_groups")+":</label>";for(var d in this.groups){u=this.groups[d].id;var v=this.groups[d].name,m=t.groups instanceof Array&&t.groups.indexOf(u)>-1?"checked":"";r+="<br><label><input value="+u+' type="checkbox" name=groups[] '+m+">"+"&nbsp;"+v+"</label>"}r+="</div>"}i=e.Node.create("<span> "+r+" </span>"),t.duration!==undefined&&i.one("input[name=duration]").set("value",t.duration),t.mode!==undefined&&i.one("select[name=mode] option[value="+t.mode+"]").set("selected","selected"),t.auto_rescheduling!==undefined&&(o=t.auto_rescheduling?"checked":null,i.one("#"+c).set("checked",o)),t.scheduling_required!==undefined&&(o=t.scheduling_required?"checked":null,i.one("#"+l).set("checked",o)),t.rules===undefined&&(t.rules=this.rules);for(var g in t.rules)t.rules[g]&&i.one(".rules input[name="+g+"]").set("checked","checked");return M.availability_examus.form.addedEvents||(M.availability_examus.form.addedEvents=!0,s=e.one(".availability-field"),s.delegate("valuechange",function(){M.core_availability.form.update()},".availability_examus input[name=duration]"),s.delegate("valuechange",function(){M.core_availability.form.update()},".availability_examus select[name=mode]"),s.delegate("click",function(){M.core_availability.form.update()},".availability_examus .rules input"),s.delegate("click",function(){M.core_availability.form.update()},".availability_examus input[type=checkbox]")),i},M.availability_examus.form.fillValue=function(t,n){var r,i;t.duration=n.one("input[name=duration]").get("value").trim(),t.mode=n.one("select[name=mode]").get("value").trim(),t.auto_rescheduling=n.one("input[name=auto_rescheduling]").get("checked"),t.scheduling_required=n.one("input[name=scheduling_required]").get("checked"),t.rules={},r=n.all(".rules input"),e.each(r,function(e){i=e.get("value"),e.get("checked")===!0?t.rules[i]=!0:t.rules[i]=!1}),t.groups=[],r=n.all(".groups input"),e.each(r,function(e){var n=e.get("value");e.get("checked")===!0&&t.groups.push(n)})},M.availability_examus.form.fillErrors=function(e,t){var n={};this.fillValue(n,t),(n.duration===undefined||!(new RegExp("^\\d+$")).test(n.duration)||n.duration%30!==0)&&e.push("availability_examus:error_setduration")}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});
